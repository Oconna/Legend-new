<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Strategiespiel - Lobby</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <header class="game-header">
            <h1>üè∞ Online Strategiespiel</h1>
            <p>Erobere St√§dte, f√ºhre Armeen, herrsche √ºber das Land!</p>
            <div class="connection-status">
                Status: <span id="connectionStatus" class="status disconnected">Verbindung wird hergestellt...</span>
            </div>
        </header>

        <main class="lobby-main">
            <!-- Player Info Section -->
            <section class="player-section">
                <div class="player-info">
                    <label for="playerNameInput">Dein Name:</label>
                    <input type="text" id="playerNameInput" placeholder="Spielername eingeben..." maxlength="20">
                </div>
            </section>

            <!-- Game List Section -->
            <section id="gameListSection" class="game-list-section">
                <div class="section-header">
                    <h2>Verf√ºgbare Spiele</h2>
                    <button id="createGameBtn" class="btn btn-primary" disabled>Neues Spiel erstellen</button>
                </div>
                
                <div class="games-container">
                    <div id="gamesList" class="games-list">
                        <div class="loading">Lade Spiele...</div>
                    </div>
                    <div class="games-actions">
                        <button id="joinGameBtn" class="btn btn-success" disabled>Spiel beitreten</button>
                        <button id="refreshGamesBtn" class="btn btn-secondary">Aktualisieren</button>
                    </div>
                </div>
            </section>

            <!-- Game Lobby Section -->
            <section id="gameLobbySection" class="game-lobby-section" style="display: none;">
                <div class="lobby-header">
                    <div class="lobby-info">
                        <h2>Spiellobby: <span id="currentGameName">-</span></h2>
                        <div class="lobby-details">
                            <span>Spieler: <span id="currentGamePlayerCount">0</span>/<span id="currentGameMaxPlayers">0</span></span>
                            <span>Kartengr√∂√üe: <span id="currentGameMapSize">0</span>x<span id="currentGameMapSize">0</span></span>
                        </div>
                    </div>
                    <div class="lobby-actions">
                        <button id="readyBtn" class="btn btn-success">Bereit</button>
                        <button id="startGameBtn" class="btn btn-primary" style="display: none;" disabled>Spiel starten</button>
                        <button id="leaveGameBtn" class="btn btn-danger">Verlassen</button>
                    </div>
                </div>

                <div class="lobby-content">
                    <!-- Players List -->
                    <div class="lobby-players">
                        <h3>Spieler im Spiel</h3>
                        <div id="gameLobbyPlayersList" class="players-list">
                            <!-- Players will be listed here -->
                        </div>
                        <div id="lobbyStatusText" class="lobby-status">
                            Warte auf andere Spieler...
                        </div>
                    </div>

                    <!-- Lobby Chat -->
                    <div class="lobby-chat">
                        <div class="chat-container">
                            <div class="chat-header">
                                <h4>
                                    üí¨ Chat
                                    <span class="chat-status">
                                        <span id="lobbyChatPlayerCount">0</span> Spieler
                                    </span>
                                </h4>
                            </div>
                            <div class="chat-messages-container">
                                <div id="lobbyChatMessages" class="chat-messages">
                                    <!-- Chat messages will be displayed here -->
                                </div>
                            </div>
                            <div class="chat-input-container">
                                <div class="chat-input-wrapper">
                                    <textarea 
                                        id="lobbyChatMessageInput" 
                                        class="chat-input" 
                                        placeholder="Schreibe eine Nachricht..."
                                        maxlength="500"
                                        rows="1"></textarea>
                                    <button id="lobbyChatSendButton" class="chat-send-btn" title="Nachricht senden">
                                        üì§
                                    </button>
                                </div>
                                <div class="chat-controls">
                                    <small class="char-count">
                                        <span id="lobbyChatCharCount">0</span>/500
                                    </small>
                                    <small class="chat-hint">
                                        Enter zum Senden
                                    </small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Create Game Modal -->
        <div id="createGameModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Neues Spiel erstellen</h3>
                    <span class="close">&times;</span>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group">
                            <label for="gameNameInput">Spielname:</label>
                            <input type="text" id="gameNameInput" placeholder="Mein Strategiespiel" maxlength="50" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="maxPlayersInput">Anzahl Spieler (2-8):</label>
                            <select id="maxPlayersInput" required>
                                <option value="2">2 Spieler</option>
                                <option value="3">3 Spieler</option>
                                <option value="4" selected>4 Spieler</option>
                                <option value="5">5 Spieler</option>
                                <option value="6">6 Spieler</option>
                                <option value="7">7 Spieler</option>
                                <option value="8">8 Spieler</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="mapSizeInput">Kartengr√∂√üe:</label>
                            <select id="mapSizeInput" required>
                                <option value="20">Klein (20x20)</option>
                                <option value="30" selected>Mittel (30x30)</option>
                                <option value="50">Gro√ü (50x50)</option>
                                <option value="100">Sehr Gro√ü (100x100)</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary cancel-btn">Abbrechen</button>
                    <button type="button" id="confirmCreateGameBtn" class="btn btn-primary">Spiel erstellen</button>
                </div>
            </div>
        </div>

        <!-- Race Selection Modal with Chat -->
        <div id="raceSelectionModal" class="modal">
            <div class="modal-content race-selection-modal">
                <div class="modal-header">
                    <h3>Rassenwahl</h3>
                    <p>W√§hle deine Rasse f√ºr das Spiel. Jede Rasse hat einzigartige Einheiten!</p>
                </div>
                <div class="modal-body">
                    <div class="race-selection-with-chat">
                        <!-- Left side: Race Selection -->
                        <div class="race-selection-panel">
                            <div class="race-selection">
                                <div id="racesList" class="races-grid">
                                    <!-- Races will be loaded here -->
                                </div>
                                <div class="race-info">
                                    <div id="selectedRaceInfo" class="selected-race-info">
                                        <p>W√§hle eine Rasse aus der Liste oben.</p>
                                    </div>
                                </div>
                                <div class="race-selection-actions">
                                    <button id="confirmRaceBtn" class="btn btn-success" disabled>
                                        Rasse best√§tigen
                                    </button>
                                    <button id="changeRaceBtn" class="btn btn-secondary" style="display: none;">
                                        Rasse √§ndern
                                    </button>
                                </div>
                                <div class="race-selection-status">
                                    <p id="raceSelectionStatus">W√§hle deine Rasse aus...</p>
                                    <div id="raceSelectionPlayersList" class="race-players-list">
                                        <!-- Players and their race status will be shown here -->
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Right side: Chat -->
                        <div class="chat-panel">
                            <div class="chat-section">
                                <div class="chat-container">
                                    <div class="chat-header">
                                        <h4>
                                            üí¨ Chat
                                            <span class="chat-status">
                                                <span id="raceSelectionChatPlayerCount">0</span> Spieler
                                            </span>
                                        </h4>
                                    </div>
                                    <div class="chat-messages-container">
                                        <div id="chatMessages" class="chat-messages">
                                            <!-- Chat messages will be displayed here -->
                                        </div>
                                    </div>
                                    <div class="chat-input-container">
                                        <div class="chat-input-wrapper">
                                            <textarea 
                                                id="chatMessageInput" 
                                                class="chat-input" 
                                                placeholder="Schreibe eine Nachricht..."
                                                maxlength="500"
                                                rows="1"></textarea>
                                            <button id="chatSendButton" class="chat-send-btn" title="Nachricht senden">
                                                üì§
                                            </button>
                                        </div>
                                        <div class="chat-controls">
                                            <small class="char-count">
                                                <span id="chatCharCount">0</span>/500
                                            </small>
                                            <small class="chat-hint">
                                                Enter zum Senden
                                            </small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Notifications -->
        <div id="notifications" class="notifications"></div>
    </div>

    <!-- Scripts -->
    <script src="/socket.io/socket.io.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/lobby.js"></script>
</body>
</html>